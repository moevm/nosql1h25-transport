<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Customer List</title>
  <style>
    table, th, td { border: 1px solid black; border-collapse: collapse; padding: 5px; }
    input, select { margin: 5px; }
  </style>
</head>
<body>
<h2>Customer Table</h2>
<nav>
  <a href="index.html">Заказчики</a> |
  <a href="tc.html">Техника в аренду</a> |
  <a href="rent.html">Аренда</a>
</nav>
<nav>
    <a href="customer_form.html">Добавить/Редактировать заказчика</a> |
    <a href="customer_import.html">Импорт/Экспорт базы заказчиков</a>
</nav>
<br>
<label>Name: <input id="filterTypename"></label>

<button onclick="fetchCustomers()">Filter</button>
<table id="customersTable">
  <thead>
    <tr>
      <th>Name</th><th>Contact information</th><th>Address</th><th>Comments</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
<script>
  const apiUrl = 'http://localhost:8000';
  async function fetchCustomers() {
    const type_name = document.getElementById("filterTypename").value;
    
    const params = new URLSearchParams();
    if (type_name) params.append("type_name", type_name);
  
    const res = await fetch(`${apiUrl}/customers?${params}`);
    const data = await res.json();
    const tbody = document.querySelector("#customersTable tbody");
    tbody.innerHTML = "";
    data.forEach(d => {
      tbody.innerHTML += `<tr>
        <td><a href="customer_detail.html?name=${encodeURIComponent(d.name)}">${d.name}</a></td>
        <td>${d.contact_information}</td>
        <td>${d.address}</td>
        <td>${d.comments || ''}</td>
      </tr>`;
    });
  }
  fetchCustomers();
</script>
</body>
</html> 