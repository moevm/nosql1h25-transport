<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TC List</title>
  <style>
    table, th, td { border: 1px solid black; border-collapse: collapse; padding: 5px; }
    input, select { margin: 5px; }
  </style>
</head>
<body>
<h2>Rent Table</h2>
<nav>
  <a href="index.html">Заказчики</a> |
  <a href="tc.html">Техника в аренду</a> |
  <a href="rent.html">Аренда</a>
</nav>
<nav>
    <a href="rent_form.html">Добавить/Редактировать транзакцию</a> |
    <a href="rent_import.html">Импорт/Экспорт базы транзакций</a>
</nav>
<br>
<label>Customer name: <input id="filterTypeordername"></label>
<label>Registration number: <input id="filterTyperegistrationnumber"></label>
<label>Rent ID: <input id="filterTyperentid"></label>
<label>Date of begining: <input id="filterTypedateofbegining"></label>
<label>Date of ending: <input id="filterTypedateofending"></label>

<button onclick="fetchRents()">Filter</button>
<table id="rentsTable">
  <thead>
    <tr>
      <th>Rent_id</th><th>Date of begining</th><th>Date of ending</th><th>Customer name</th><th>TC registration number</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
<script>
  const apiUrl = 'http://localhost:8000';
  async function fetchRents() {
    const type_order_name = document.getElementById("filterTypeordername").value;
    const type_registration_number = document.getElementById("filterTyperegistrationnumber").value;
    const type_rent_id = document.getElementById("filterTyperentid").value;
    const type_date_of_begining = document.getElementById("filterTypedateofbegining").value;
    const type_date_of_ending = document.getElementById("filterTypedateofending").value;

    const params = new URLSearchParams();
    if (type_order_name) params.append("type_order_name", type_order_name);
    if (type_registration_number) params.append("type_registration_number", type_registration_number);
    if (type_rent_id) params.append("type_rent_id", type_rent_id);
    if (type_date_of_begining) params.append("type_date_of_begining", type_date_of_begining);
    if (type_date_of_ending) params.append("type_date_of_ending", type_date_of_ending);
    const res = await fetch(`${apiUrl}/rents?${params}`);
    const data = await res.json();
    const tbody = document.querySelector("#rentsTable tbody");
    tbody.innerHTML = "";
    data.forEach(d => {
      tbody.innerHTML += `<tr>
       
        <td><a href="rent_detail.html?rent_id=${encodeURIComponent(d.rent_id)}">${d.rent_id}</a></td>

        <td>${d.date_of_begining}</td>
        <td>${d.date_of_ending}</td>
        <td>${d.order_name}</td>
        <td>${d.tc_registration_number}</td>
      </tr>`;
    });
  }
  fetchRents();
</script>
</body>
</html> 