<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Добавить / Редактировать Водителя</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 20px auto; }
    label { display: block; margin-top: 10px; }
    input, select, textarea { width: 100%; padding: 8px; margin-top: 4px; box-sizing: border-box; }
    button { margin-top: 15px; margin-right: 10px; padding: 8px 15px; cursor: pointer; }
  </style>
</head>
<body>
  <nav>
  <a href="index.html">Заказчики</a> |
  <a href="tc.html">Техника в аренду</a> |
  <a href="rent.html">Аренда</a>
</nav>
<nav>
    <a href="tc_form.html">Добавить/Редактировать технику</a> |
    <a href="tc_import.html">Импорт/Экспорт базы техники</a>
</nav>
<h2>Подробная информация о технике</h2>

<div id="detailsContainer"></div>

<script>
  // Получение параметра registration_number из URL
  function getQueryParam(param) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(param);
  }

  const registrationNumber = getQueryParam('registration_number');

  if (!registrationNumber) {
    document.getElementById('detailsContainer').innerHTML = '<p>Не указан регистрационный номер.</p>';
  } else {
    // API-запрос для получения данных о технике
    const apiUrl = 'http://localhost:8000/tcs/' + encodeURIComponent(registrationNumber);
    fetch(apiUrl)
      .then(response => {
        if (!response.ok) {
          throw new Error('Ошибка при получении данных');
        }
        return response.json();
      })
      .then(data => {
        // Формируем таблицу с данными
        const html = `
          <table>
            <tr><th>Тип ТК</th><td>${data.type_tc}</td></tr>
            <tr><th>Регистрационный номер</th><td>${data.registration_number}</td></tr>
            <tr><th>Доступен</th><td>${data.is_available ? 'Да' : 'Нет'}</td></tr>
            <tr><th>Комментарии</th><td>${data.comments || ''}</td></tr>
          </table>
        `;
        document.getElementById('detailsContainer').innerHTML = html;
      })
      .catch(err => {
        document.getElementById('detailsContainer').innerHTML = '<p>Ошибка при получении данных о технике.</p>';
        console.error(err);
      });
  }
</script>
</body>
</html>