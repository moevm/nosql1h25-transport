<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Импорт/Экспорт</title>
</head>
<body>
<h2>Импорт/Экспорт</h2>
<nav>
  <a href="index.html">Заказчики</a> |
  <a href="tc.html">Техника в аренду</a> |
  <a href="import.html">Аренда</a>
</nav>
<nav>
    <a href="rent_form.html">Добавить/Редактировать транзакцию</a> |
    <a href="rent_import.html">Импорт/Экспорт базы транзакций</a>
</nav>
<br>
<button onclick="exportRents()">Export</button>
<input type="file" id="importFile">
<button onclick="importRents()">Import</button>
<script>
  const apiUrl = 'http://localhost:8000';
  async function exportRents() {
    const res = await fetch(`${apiUrl}/rents/export`);
    const data = await res.json();
    const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'rents.json';
    a.click();
  }
  async function importRents() {
    const file = document.getElementById("importFile").files[0];
    const text = await file.text();
    const data = JSON.parse(text);
    await fetch(`${apiUrl}/rents/import`, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(data)
    });
    alert("Transactions imported");
  }
</script>
</body>
</html>